##========---
##=- VALET
##=====---
# Vapour Technology All-Purpose Library
# Copyright 2001 Vapour Technology Ltd.
#
# Add confidentiality notice

# NOTE: Will eventually be generated by VMake

# 23/09/2001 - Warren Moore
# $Id: Makefile,v 1.7 2001/10/24 14:22:11 vap-warren Exp $

LIB = libVALETcore.a
OBJS = $(LIB)(loghandle.o logmanager.o log.o)
INC_HEADERS = log.h log_inline.cpp logmanager.h logmanager_inline.cpp
CLEAN_FILES = log.test test.log
VMAKE_FILES = loghandle.cpp loghandle.h log_test.cpp
TEST_OBJS = log.test.o log_test.o
TEST_LIBS =  -lVALETcore -lVALETarch
TEST_APP = log.test

include ../base.mk

# Targets

test: build $(TEST_OBJS)
ifneq "$(ARCH)" "dc"
##===--- noarch
	$(CXX) $(CFLAGS) $(CXXFLAGS) $(LDFLAGS) $(TEST_OBJS) $(TEST_LIBS) -o $(TEST_APP) && \
	chmod 755 $(TEST_APP) && \
	./$(TEST_APP)
else
##===--- dc
	$(CXX) $(CFLAGS) $(CXXFLAGS) $(LDFLAGS) $(TEST_OBJS) $(TEST_LIBS) -o $(TEST_APP) && \
	$(KOS_LOADER) $(TEST_APP) > test.log 2>&1
endif
