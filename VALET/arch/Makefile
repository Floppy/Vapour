##========---
##=- VALET
##=====---
# Vapour Technology All-Purpose Library
# Copyright 2001 Vapour Technology Ltd.
#
# Add confidentiality notice

# NOTE: Will eventually be generated by VMake

# 16/10/2001 - Warren Moore
# $Id: Makefile,v 1.2 2001/10/16 22:31:17 vap-warren Exp $

# section specific
VALET_INC = ../include
VALET_LIB = ../lib

LIB = libVALETarch.a
OBJS = $(LIB)(memory.o)
TESTOBJS =

##===--- noarch
MAKE = make
CC = gcc
CXX = g++
CFLAGS = -g -O -Wall -I$(VALET_INC)
CXXFLAGS = 
AR = ar
ARFLAGS = rcs
RANLIB = ranlib
LD = ld
LDFLAGS = -L$(VALET_LIB) 

##===--- dc
KOS_ARCH_DIR = $(KOS_BASE)/kernel/arch/$(KOS_ARCH)
KOS_START = $(KOS_ARCH_DIR)/kernel/startup.o

#CC = $(KOS_CC)
#CXX = $(KOS_CCPLUS)
#CFLAGS = $(KOS_CFLAGS) -D_arch_$(KOS_ARCH) -I$(VALET_INC) -I$(KOS_INCS) -I$(KOS_BASE)/kernel/arch/$(KOS_ARCH)/include
#CXXFLAGS = $(KOS_CPPFLAGS)
#AR = $(KOS_AR)
#ARFLAGS = rcs
#RANLIB = /usr/local/dc/sh-elf/bin/sh-elf-ranlib
#LD = $(KOS_LD)
#LDFLAGS = $(KOS_LDFLAGS) -L$(VALET_LIB) $(KOS_START) -L$(KOS_BASE)/lib

.PHONY: all build

# Targets

all: build

build: $(LIB)
	-mkdir ../lib 2> /dev/null ; \
	cp libVALETarch.a ../lib
	-mkdir ../include 2> /dev/null ; \
	cp valet.h valet_common.h ../include

$(LIB): $(OBJS)
	$(RANLIB) $(LIB)

test: build 

clean:
	rm -rf $(LIB) *.o *~ 
	
distclean: clean
	rm -rf valet.h memory.cpp
	
# Production rules
	
.cpp.o:
	$(CXX) $(CFLAGS) $(CXXFLAGS) -c $<

.cpp.a:
	$(CXX) $(CFLAGS) $(CXXFLAGS) -c $<
	$(AR) $(ARFLAGS) $@ $%

# Default

.DEFAULT:
	@echo Unknown target $@
	

